# Azure LLM 配置文档

## 1. 服务信息
- `provider`: Azure OpenAI
- `endpoint_url`: `https://octave-openai-test002.openai.azure.com/`
- `deployment_name`: `gpt-5.2-chat`
- `chat_completions_url`: `https://octave-openai-test002.openai.azure.com/openai/deployments/gpt-5.2-chat/chat/completions?api-version=2025-01-01-preview`
- `api_version`: `2025-01-01-preview`

## 2. 密钥配置（安全方式）
不要把密钥硬编码进代码，统一使用环境变量。

```bash
export ENDPOINT_URL="https://octave-openai-test002.openai.azure.com/"
export DEPLOYMENT_NAME="gpt-5.2-chat"
export AZURE_OPENAI_API_KEY="<请填写你的真实密钥>"
```

你提供的密钥已识别为敏感信息，文档中不做明文落盘。

## 3. Python 调用示例（已按当前参数填写）
```python
import os
from openai import AzureOpenAI

endpoint = os.getenv("ENDPOINT_URL", "https://octave-openai-test002.openai.azure.com/")
deployment = os.getenv("DEPLOYMENT_NAME", "gpt-5.2-chat")
subscription_key = os.getenv("AZURE_OPENAI_API_KEY", "<请填写你的真实密钥>")

# 使用密钥方式初始化 Azure OpenAI 客户端
client = AzureOpenAI(
    azure_endpoint=endpoint,
    api_key=subscription_key,
    api_version="2025-01-01-preview",
)

messages = [
    {
        "role": "system",
        "content": [
            {
                "type": "text",
                "text": "你是一个帮助用户查找信息的 AI 助手。"
            }
        ]
    }
]

completion = client.chat.completions.create(
    model=deployment,
    messages=messages,
    max_completion_tokens=6553,
    stop=None,
    stream=False,
)

print(completion.to_json())
```

## 4. 连通性测试
```bash
python -c "import os;from openai import AzureOpenAI;client=AzureOpenAI(azure_endpoint=os.getenv('ENDPOINT_URL'),api_key=os.getenv('AZURE_OPENAI_API_KEY'),api_version='2025-01-01-preview');print(client.chat.completions.create(model=os.getenv('DEPLOYMENT_NAME','gpt-5.2-chat'),messages=[{'role':'system','content':[{'type':'text','text':'ping'}]}],max_completion_tokens=16).to_json())"
```

## 5. 常见问题
1. `401 Unauthorized`
- 检查 `AZURE_OPENAI_API_KEY` 是否有效、是否有权限访问该 deployment。

2. `404 Deployment not found`
- 检查 `DEPLOYMENT_NAME` 是否为 `gpt-5.2-chat`，且部署位于同一资源实例。

3. `400 api-version invalid`
- 检查请求中的 `api-version=2025-01-01-preview` 是否与 SDK 参数一致。
